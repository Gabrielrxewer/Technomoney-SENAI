const encode = (input) => {
  const buf = Buffer.isBuffer(input) ? input : Buffer.from(String(input));
  return buf
    .toString("base64")
    .replace(/\+/g, "-")
    .replace(/\//g, "_")
    .replace(/=+$/g, "");
};

const pad = (str) => {
  const mod = str.length % 4;
  if (mod === 0) return str;
  return str + "=".repeat(4 - mod);
};

const toBuffer = (input) => {
  const normalized = pad(String(input)).replace(/-/g, "+").replace(/_/g, "/");
  return Buffer.from(normalized, "base64");
};

module.exports = {
  encode,
  toBuffer,
};
